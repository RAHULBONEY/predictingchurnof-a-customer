<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Customer Churn Prediction</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .form-select,
      .form-input,
      .form-radio {
        transition: all 0.3s ease;
      }
      .result-card {
        transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
      }
    </style>
  </head>
  <body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-4xl bg-white rounded-xl shadow-lg p-6 md:p-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800">
          Customer Churn Prediction
        </h1>
        <p class="text-gray-500 mt-2">
          Enter the customer's details to predict their likelihood of churning.
        </p>
      </div>

      <!-- Form -->
      <form
        id="churnForm"
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
      >
        <!-- Column 1 -->
        <div class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Contract</label
            >
            <select
              id="contract"
              class="form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            >
              <option>Month-to-month</option>
              <option>One year</option>
              <option>Two year</option>
            </select>
          </div>
          <div>
            <label for="tenure" class="block text-sm font-medium text-gray-700"
              >Tenure (Months)</label
            >
            <input
              type="number"
              id="tenure"
              value="1"
              min="0"
              max="72"
              class="form-input mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Internet Service</label
            >
            <select
              id="internetService"
              class="form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            >
              <option>Fiber optic</option>
              <option>DSL</option>
              <option>No</option>
            </select>
          </div>
        </div>

        <!-- Column 2 -->
        <div class="space-y-6">
          <div>
            <label
              for="monthlyCharges"
              class="block text-sm font-medium text-gray-700"
              >Monthly Charges ($)</label
            >
            <input
              type="number"
              id="monthlyCharges"
              value="70"
              min="18"
              max="120"
              step="0.01"
              class="form-input mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            />
          </div>
          <div>
            <label
              for="totalCharges"
              class="block text-sm font-medium text-gray-700"
              >Total Charges ($)</label
            >
            <input
              type="number"
              id="totalCharges"
              value="70"
              min="0"
              step="0.01"
              class="form-input mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Tech Support</label
            >
            <select
              id="techSupport"
              class="form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            >
              <option>No</option>
              <option>Yes</option>
              <option>No internet service</option>
            </select>
          </div>
        </div>

        <!-- Column 3 -->
        <div class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Online Security</label
            >
            <select
              id="onlineSecurity"
              class="form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            >
              <option>No</option>
              <option>Yes</option>
              <option>No internet service</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Payment Method</label
            >
            <select
              id="paymentMethod"
              class="form-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            >
              <option>Electronic check</option>
              <option>Mailed check</option>
              <option>Bank transfer (automatic)</option>
              <option>Credit card (automatic)</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Paperless Billing</label
            >
            <div class="mt-1 flex space-x-4">
              <label class="inline-flex items-center">
                <input
                  type="radio"
                  class="form-radio text-indigo-600"
                  name="paperlessBilling"
                  value="Yes"
                  checked
                />
                <span class="ml-2 text-gray-700">Yes</span>
              </label>
              <label class="inline-flex items-center">
                <input
                  type="radio"
                  class="form-radio text-indigo-600"
                  name="paperlessBilling"
                  value="No"
                />
                <span class="ml-2 text-gray-700">No</span>
              </label>
            </div>
          </div>
        </div>
      </form>

      <!-- Button -->
      <div class="mt-8 text-center">
        <button
          id="predictBtn"
          class="w-full md:w-auto bg-indigo-600 text-white font-bold py-3 px-12 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform transform hover:scale-105"
        >
          Predict Churn
        </button>
      </div>

      <!-- Result -->
      <div
        id="result"
        class="result-card mt-8 border-t pt-6 text-center opacity-0 transform -translate-y-4"
      >
        <h2 class="text-2xl font-semibold text-gray-800 mb-2">
          Prediction Result
        </h2>
        <div
          id="predictionOutput"
          class="text-4xl font-bold p-4 rounded-lg inline-block"
        ></div>
        <p class="text-gray-600 mt-2">
          Churn Probability:
          <span id="probabilityOutput" class="font-semibold"></span>
        </p>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const predictBtn = document.getElementById("predictBtn");
        const resultDiv = document.getElementById("result");
        const predictionOutput = document.getElementById("predictionOutput");
        const probabilityOutput = document.getElementById("probabilityOutput");
        const tenureInput = document.getElementById("tenure");
        const monthlyChargesInput = document.getElementById("monthlyCharges");
        const totalChargesInput = document.getElementById("totalCharges");

        // Auto-update total charges based on tenure and monthly charges for convenience
        const updateTotalCharges = () => {
          const tenure = parseFloat(tenureInput.value) || 0;
          const monthly = parseFloat(monthlyChargesInput.value) || 0;
          totalChargesInput.value = (tenure * monthly).toFixed(2);
        };
        tenureInput.addEventListener("input", updateTotalCharges);
        monthlyChargesInput.addEventListener("input", updateTotalCharges);

        predictBtn.addEventListener("click", () => {
          // --- SIMULATED MODEL LOGIC ---
          // This function mimics the real XGBoost model by assigning weights to features
          // based on our findings from the notebook. It's a simplified representation.

          let score = 0;

          // 1. Get all input values
          const contract = document.getElementById("contract").value;
          const tenure = parseInt(document.getElementById("tenure").value);
          const internetService =
            document.getElementById("internetService").value;
          const monthlyCharges = parseFloat(
            document.getElementById("monthlyCharges").value
          );
          const techSupport = document.getElementById("techSupport").value;
          const onlineSecurity =
            document.getElementById("onlineSecurity").value;
          const paymentMethod = document.getElementById("paymentMethod").value;
          const paperlessBilling = document.querySelector(
            'input[name="paperlessBilling"]:checked'
          ).value;

          // 2. Apply weights based on feature importance
          // Higher positive score means higher churn risk.

          // Contract (very high importance)
          if (contract === "Month-to-month") score += 35;
          if (contract === "One year") score -= 20;
          if (contract === "Two year") score -= 40;

          // Tenure (very high importance)
          if (tenure <= 6) score += 25;
          else if (tenure <= 12) score += 10;
          else if (tenure > 36) score -= tenure - 36; // The longer, the better

          // Internet Service (high importance)
          if (internetService === "Fiber optic") score += 25;
          if (internetService === "No") score -= 20;

          // Tech Support & Online Security (medium importance)
          if (techSupport === "No") score += 15;
          if (onlineSecurity === "No") score += 15;

          // Payment Method (medium importance)
          if (paymentMethod === "Electronic check") score += 10;

          // Paperless Billing
          if (paperlessBilling === "Yes") score += 5;

          // Monthly Charges (lower importance, but contributes)
          if (monthlyCharges > 90) score += 10;

          // 3. Normalize score to a probability (0% to 100%)
          // Using a simplified sigmoid-like transformation
          const probability = 1 / (1 + Math.exp(-(score - 40) / 25)); // Centered around a score of 40
          const probabilityPercent = (probability * 100).toFixed(2);

          // 4. Display the result
          resultDiv.classList.remove("opacity-0", "-translate-y-4");
          resultDiv.classList.add("opacity-100", "translate-y-0");

          probabilityOutput.textContent = `${probabilityPercent}%`;

          if (probability > 0.5) {
            predictionOutput.textContent = "High Risk of Churn";
            predictionOutput.className =
              "text-4xl font-bold p-4 rounded-lg inline-block bg-red-100 text-red-700";
          } else {
            predictionOutput.textContent = "Low Risk of Churn";
            predictionOutput.className =
              "text-4xl font-bold p-4 rounded-lg inline-block bg-green-100 text-green-700";
          }
        });
      });
    </script>
  </body>
</html>
